<odoo>
    <data>
    <template id="report_delivery_remito_document">
              <t t-call="web.html_container">
                <t t-call="web.external_layout">
                    <t t-set="o" t-value="o.with_context(lang=lang)"/>
                    <t t-set="custom_header" t-value="'custom_remito.stock_remito_header'"/>
                    <t t-set="report_date" t-value="o.date"/>
                    <t t-set="document_letter" t-value="'R'"/>
                    <t t-set="document_legend" t-value="'Cod. 91 - Doc. no válido como factura'"/>
                    <t t-set="report_number" t-value="o.name"/>
                    <t t-set="report_name" t-value="'Remito'"/>
                    <t t-set="header_address" t-value="o.company_id.partner_id"/>
                    
                    <t t-set="custom_footer">
                            
                            <div class="row pt-4">
                                <div name="footer_left_column" class="col-4">
                                    <span/>
                                </div>
                                <div name="footer_left_column" class="col-4">
                                    <div>
                                        <div class="pb-2 text-center">C.A.I. N° <strong>50304208233990</strong></div>
                                        <div class="pb-2 text-center">Vencimiento: 25-07-2025</div>
                                        <div class="pb-2 text-center" style="font-size:12px">N° 0006-00021151 -N° 0006-00021350</div>
                                    </div>
                                </div>
                                <!--<div name="footer_right_column" class="col-4 test-class">
                                    <div class="text-right" name="pager" t-if="report_type == 'pdf'">
                                        Page: <span class="page"/> / <span class="topage"/>
                                    </div>
                                </div>-->
                        </div>
                    </t>

                    <div class="page">
                        <div class="oe_structure"/>
                        <div class="row mt8 mb8">
                            <div t-if="o.origin" class="col-auto" name="div_origin">
                                <strong>Condicion de venta:</strong>
                                <p t-field="o.origin">S0001</p>
                            </div>
                            <div t-if="o.state" class="col-auto" name="div_sched_date">
                                <strong>Fecha de envio:</strong>
                                    <p t-if="o.state == 'done'" t-field="o.date_done"/>
                                    <p t-else="" t-field="o.scheduled_date"/>
                            </div>
                        </div>
                        <div class="oe_structure"/>
                        <table class="table table-sm" t-if="o.state!='done'" name="stock_move_table">
                            <thead>
                                <tr>
                                    <th name="th_sm_product"><strong>Descripción</strong></th>
                                    <th name="th_sm_quantity"><strong>Cantidad</strong></th>
                                </tr>
                            </thead>
                            <tbody>
                                <t t-set="lines" t-value="o.move_ids.filtered(lambda x: x.product_uom_qty)"/>
                                <tr t-foreach="lines" t-as="move">
                                    <td>
                                        <span t-field="move.product_id">Customizable Desk</span>
                                        <p t-if="move.description_picking != move.product_id.name and move.description_picking != move.product_id.display_name">
                                            <span t-field="move.description_picking">Description on transfer</span>
                                        </p>
                                    </td>
                                    <td>
                                        <span t-field="move.product_uom_qty">3.00</span>
                                        <span t-field="move.product_uom">UN</span>
                                        <span t-if="move.product_packaging_id">
                                            (<span t-field="move.product_packaging_qty" t-options="{&quot;widget&quot;: &quot;integer&quot;}"/> <span t-field="move.product_packaging_id"/>)
                                        </span>
                                    </td>
                                    <!--<td>
                                        <span t-field="move.quantity">3.00</span>
                                        <span t-field="move.product_uom">units</span>
                                        <span t-if="move.product_packaging_id">
                                            (<span t-field="move.product_packaging_quantity" t-options="{&quot;widget&quot;: &quot;integer&quot;}"/> <span t-field="move.product_packaging_id"/>)
                                        </span>
                                    </td>-->
                                </tr>
                            </tbody>
                        </table>
                        <table class="table table-sm mt48 border rounded " t-elif="o.move_line_ids and o.state=='done'">
                            <t t-set="has_serial_number" t-value="False"/>
                            <t t-set="has_serial_number" t-value="o.move_line_ids.mapped('lot_id')" groups="stock.group_lot_on_delivery_slip"/>
                            <thead class="border rounded" t-att-style="'background-color:%s;border:2px solid %s !important;' % (o.company_id.primary_color,o.company_id.primary_color)">
                                <tr>
                                    <th name="th_sml_product" t-att-style="'border-right:2px solid %s !important;color:white !important;' % o.company_id.primary_color"><strong>Descripción</strong></th>
                                    <!--<th name="th_sml_qty_ordered" class="text-center" t-if="not has_serial_number">
                                        <strong>Ordenado</strong>
                                    </th>
                                    <th name="lot_serial" t-else="">
                                        N° de serie
                                    </th>-->
                                    <th name="th_sml_quantity" style="color:white !important;"><strong>Cantidad</strong></th>
                                </tr>
                            </thead>
                            <tbody t-att-style="'border:2px solid %s !important;' % o.company_id.primary_color">
                                <t t-set="lines" t-value="o.move_ids.filtered(lambda x: x.product_uom_qty)"/>
                                    <tr t-foreach="lines" t-as="move" t-att-style="'border-right:2px solid %s !important;' % o.company_id.primary_color">
                                        <td t-att-style="'border-right:2px solid %s !important;' % o.company_id.primary_color">
                                             <span t-field="move.product_id">Customizable Desk</span>
                                                <p t-if="move.description_picking != move.product_id.name and move.description_picking != move.product_id.display_name">
                                                    <span t-field="move.description_picking">Description on transfer</span>
                                                </p>
                                        </td>
                                        <td class="border rounded">
                                            <span t-field="move.quantity">3.00</span>
                                                <span t-field="move.product_uom">UN</span>
                                                <span t-if="move.product_packaging_id">
                                                    (<span t-field="move.product_packaging_qty" t-options="{&quot;widget&quot;: &quot;integer&quot;}"/> <span t-field="move.product_packaging_id"/>)
                                                </span>
                                        </td>
                                    </tr>
                            <!-- This part gets complicated with different use cases (additional use cases in extensions of this report):
                                    1. If serial numbers are used and set to print on delivery slip => print lines as is, otherwise group them by overlapping
                                        product + description + uom combinations
                                    2. If any packages are assigned => split products up by package (or non-package) and then apply use case 1 -->
                                <!-- If has destination packages => create sections of corresponding products -->
                                <t t-if="o.has_packages" name="has_packages">
                                    <t t-set="packages" t-value="o.move_line_ids.mapped('result_package_id')"/>
                                    <t t-foreach="packages" t-as="package">
                                        <t t-call="stock.stock_report_delivery_package_section_line"/>
                                        <t t-set="package_move_lines" t-value="o.move_line_ids.filtered(lambda l: l.result_package_id == package)"/>
                                        <!-- If printing lots/serial numbers => keep products in original lines -->
                                        <t t-if="has_serial_number">
                                            <tr t-foreach="package_move_lines" t-as="move_line">
                                                <t t-call="stock.stock_report_delivery_has_serial_move_line"/>
                                            </tr>
                                        </t>
                                        <!-- If not printing lots/serial numbers => merge lines with same product+description+uom -->
                                        <t t-else="">
                                            <t t-set="aggregated_lines" t-value="package_move_lines._get_aggregated_product_quantities(strict=True)"/>
                                            <t t-call="stock.stock_report_delivery_aggregated_move_lines"/>
                                        </t>
                                    </t>
                                    <!-- Make sure we do another section for package-less products if they exist -->
                                    <t t-set="move_lines" t-value="o.move_line_ids.filtered(lambda l: not l.result_package_id)"/>
                                    <t t-set="aggregated_lines" t-value="o.move_line_ids._get_aggregated_product_quantities(except_package=True)"/>
                                    <t t-if="move_lines or aggregated_lines" name="no_package_move_lines">
                                        <t t-call="stock.stock_report_delivery_no_package_section_line" name="no_package_section"/>
                                        <t t-if="has_serial_number">
                                            <tr t-foreach="move_lines" t-as="move_line">
                                                <t t-call="stock.stock_report_delivery_has_serial_move_line"/>
                                            </tr>
                                        </t>
                                        <t t-elif="aggregated_lines">
                                            <t t-call="stock.stock_report_delivery_aggregated_move_lines"/>
                                        </t>
                                    </t>
                                </t>
                                <!-- No destination packages -->
                                <t t-else="">
                                    <!-- If printing lots/serial numbers => keep products in original lines
                                    <t t-if="has_serial_number">
                                        <tr t-foreach="o.move_line_ids" t-as="move_line">
                                            <t t-call="stock.stock_report_delivery_has_serial_move_line"/>
                                        </tr>
                                    </t>
                                    <t t-else="" name="aggregated_move_lines">
                                        <t t-set="aggregated_lines" t-value="o.move_line_ids._get_aggregated_product_quantities()"/>
                                        <t t-call="stock.stock_report_delivery_aggregated_move_lines"/> 
                                    </t>-->
                                </t>
                            </tbody>
                        </table>
                        <div class="oe_structure"/>
                        <t t-set="backorders" t-value="o.backorder_ids.filtered(lambda x: x.state not in ('done', 'cancel'))"/>
                        <div t-if="not (o.backorder_ids and backorders)" class="oe_structure"/>
                        <div t-else="">
                            <p class="mt-5">
                                <span>Remaining quantities not yet delivered:</span>
                            </p>
                            <table class="table table-sm" name="stock_backorder_table" style="table-layout: fixed;">
                                <thead>
                                    <tr>
                                        <th name="th_sb_product"><strong>Product</strong></th>
                                        <th/>
                                        <th name="th_sb_quantity" class="text-center"><strong>Quantity</strong></th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr t-foreach="backorders.mapped('move_ids').filtered(lambda x: x.product_uom_qty)" t-as="bo_line">
                                        <td class="w-auto">
                                            <span t-field="bo_line.product_id">Office Chair</span>
                                            <p t-if="bo_line.description_picking != bo_line.product_id.name and bo_line.description_picking != bo_line.product_id.display_name">
                                                <span t-field="bo_line.description_picking">Description on transfer</span>
                                            </p>
                                        </td>
                                        <td/>
                                        <td class="text-center w-auto">
                                            <span t-field="bo_line.product_uom_qty">3.00</span>
                                            <span t-field="bo_line.product_uom">UN</span>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
    <!--
                        <div t-if="not o.signature" class="oe_structure"/>
                        <div t-else="" class="mt32 ml64 mr4" name="signature">
                            <div class="offset-8">
                                <strong>Signature</strong>
                            </div>
                            <div class="offset-8">
                                <img t-att-src="image_data_uri(o.signature)" style="max-height: 4cm; max-width: 8cm;"/>
                            </div>
                            <div class="offset-8 text-center">
                                <p t-field="o.partner_id.name">John Doe</p>
                            </div>
                        </div>-->
                    </div>
                        <div class="text-center pb-2 m0" t-att-style="'background-color: %s;height:10px;margin-bottom:-1px' % o.company_id.primary_color">
                        </div>
                        <div class="row" t-att-style="'border:2px solid %s !important;border-radius:0 0 20px 20px !important;' % o.company_id.primary_color">
                            <div name="footer_left_column" class="col-6">
                                <div class="container" style="padding-top: 20px !important">
                                    <div class="pt-2 pb-2">Transportista:</div>
                                    <div class="pt-2 pb-2">Domicilio    :</div>
                                    <div class="pt-2 pb-2">CUIT         :</div>
                                </div>
                            </div>
                            <div name="footer_right_column" class="col-6" t-att-style="'border-left:1px solid %s !important;' % o.company_id.primary_color">
                                    <div class="p-2" style="padding-bottom:50px !important">
                                        <span>Recibi/mos conforme la mercadería descripta en este remito:</span>
                                    </div>
                                    <div class="p-2">
                                        <span class="text-center">Firma:</span>
                                    </div>
                                    
                            </div>
                        </div>

                </t>
             </t>
        </template>
    
        <template id="report_delivery_remito">
                <t t-call="web.html_container">
                    <t t-foreach="docs" t-as="o">
                        <t t-set="lang" t-value="o.partner_id.lang"/>
                        <t t-call="custom_remito.report_delivery_remito_document" t-lang="lang"/>
                    </t>
                </t>
            </template>
        
            <!-- Acción para generar el reporte -->
            <record id="action_custom_remito" model="ir.actions.report">
                <field name="name">Remito</field>
                <field name="model">stock.picking</field>
                <field name="binding_model_id" ref="stock.model_stock_picking"/>
                <field name="report_type">qweb-pdf</field>
                <field name="print_report_name">'Remito'</field>
                <field name="report_name">custom_remito.report_delivery_remito</field>
                <field name="report_file">custom_remito.report_delivery_remito</field>
            </record>
    </data>
  </odoo>